CREATE DATABASE AGENDA;

USE AGENDA;

CREATE TABLE USUARIO 
(
	CODIGO VARCHAR(4) NOT NULL,
    NOMBRE_USUARIO VARCHAR(50) NOT NULL,
    CLAVE VARCHAR(50) NOT NULL,
    TIPO VARCHAR(20) NOT NULL,
    NOMBRE VARCHAR(50) NOT NULL,
    APELLIDOPAT VARCHAR(50) NOT NULL,
    APELLIDOMAT VARCHAR(50) NOT NULL,
    TELEFONO VARCHAR(9),
    CORREO VARCHAR(70),
    
    CONSTRAINT PK_USUARIO PRIMARY KEY(CODIGO),
    CONSTRAINT UQ_USUARIO_NOMBRE UNIQUE(NOMBRE_USUARIO)
);

CREATE TABLE CONTACTO
(
	CODIGO VARCHAR(4) NOT NULL,
    DNI VARCHAR(8) NOT NULL,
    NOMBRE VARCHAR(50) NOT NULL,
    APELLIDOPAT VARCHAR(50) NOT NULL,
    APELLIDOMAT VARCHAR(50) NOT NULL,
    TELEFONO VARCHAR(9),
    EDAD INT NOT NULL,
    DISTRITO VARCHAR(50) NOT NULL,
    DIRECCION VARCHAR(70) NOT NULL,
    CORREO VARCHAR(70),
    
    CONSTRAINT PK_CONTACTO PRIMARY KEY(CODIGO)
);

CREATE TABLE AGENDA
(
	CODIGO_USUARIO VARCHAR(4) NOT NULL,
    CODIGO_CONTACTO VARCHAR(4) NOT NULL,
    CONSTRAINT PK_AGENDA PRIMARY KEY(CODIGO_USUARIO,CODIGO_CONTACTO)
);


ALTER TABLE AGENDA 
ADD CONSTRAINT FK_AGENDA_USUARIO FOREIGN KEY(CODIGO_USUARIO) REFERENCES USUARIO(CODIGO)
ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE AGENDA 
ADD CONSTRAINT FK_AGENDA_CONTACTO FOREIGN KEY(CODIGO_CONTACTO) REFERENCES CONTACTO(CODIGO)
ON DELETE CASCADE ON UPDATE CASCADE;