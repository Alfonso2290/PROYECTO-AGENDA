CREATE DATABASE AGENDA;

USE AGENDA;

CREATE TABLE PERSONA
(
	DNI VARCHAR(8) NOT NULL,
    NOMBRE VARCHAR(50) NOT NULL,
    APELLIDOPAT VARCHAR(50) NOT NULL,
    APELLIDOMAT VARCHAR(50) NOT NULL,
    TELEFONO VARCHAR(9),
    EDAD INT NOT NULL,
    DISTRITO VARCHAR(50) NOT NULL,
    DIRECCION VARCHAR(70) NOT NULL,
    CORREO VARCHAR(70),
    CONSTRAINT PK_PERSONA PRIMARY KEY(DNI)
	
);

CREATE TABLE USUARIO 
(
	CODIGO VARCHAR(4) NOT NULL,
    NOMBRE VARCHAR(50) NOT NULL,
    CLAVE VARCHAR(50) NOT NULL,
    TIPO VARCHAR(20) NOT NULL,
    DNI VARCHAR(8) NOT NULL,
    CONSTRAINT PK_USUARIO PRIMARY KEY(CODIGO),
    CONSTRAINT UQ_USUARIO_NOMBRE UNIQUE(NOMBRE)
);

CREATE TABLE CONTACTO
(
	CODIGO VARCHAR(4) NOT NULL,
    DNI VARCHAR(8) NOT NULL,
    CONSTRAINT PK_CONTACTO PRIMARY KEY(CODIGO)
);

ALTER TABLE USUARIO 
ADD CONSTRAINT FK_USUARIO_PERSONA FOREIGN KEY(DNI) REFERENCES PERSONA(DNI)
ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE CONTACTO 
ADD CONSTRAINT FK_CONTACTO_PERSONA FOREIGN KEY(DNI) REFERENCES PERSONA(DNI)
ON DELETE CASCADE ON UPDATE CASCADE;